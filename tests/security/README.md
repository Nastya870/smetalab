# Security –¢–µ—Å—Ç—ã - Smeta Application

## üìã –û–±–∑–æ—Ä

Security —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∑–∞—â–∏—â—ë–Ω–Ω–æ—Å—Ç—å API –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π OWASP Top 10.

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤** | 241 |
| **–§–∞–π–ª–æ–≤ —Ç–µ—Å—Ç–æ–≤** | 5 |
| **–ü–æ–∫—Ä—ã—Ç–∏–µ** | 100% ‚úÖ |
| **–§—Ä–µ–π–º–≤–æ—Ä–∫** | Vitest + Supertest |
| **–ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫** | –î–µ–∫–∞–±—Ä—å 2025 |

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tests/security/
‚îú‚îÄ‚îÄ README.md                    # ‚Üê –í–´ –ó–î–ï–°–¨
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ sql-injection.test.js    # SQL Injection —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ xss.test.js              # Cross-Site Scripting —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ access-control.test.js   # Broken Access Control (IDOR)
‚îÇ   ‚îú‚îÄ‚îÄ auth.test.js             # Authentication —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ rate-limiting.test.js    # Rate Limiting —Ç–µ—Å—Ç—ã
‚îÇ
‚îî‚îÄ‚îÄ fixtures/
    ‚îî‚îÄ‚îÄ payloads.js              # –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ payloads –¥–ª—è —Ç–µ—Å—Ç–æ–≤
```

## üöÄ –ó–∞–ø—É—Å–∫

```powershell
# –í—Å–µ security —Ç–µ—Å—Ç—ã
npm run test:security

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
npx vitest run tests/security/api/sql-injection.test.js

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
npx vitest run tests/security --reporter=verbose
```

## üîí –ü–æ–∫—Ä—ã—Ç–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (OWASP Top 10)

| # | –£—è–∑–≤–∏–º–æ—Å—Ç—å | –§–∞–π–ª —Ç–µ—Å—Ç–æ–≤ | –°—Ç–∞—Ç—É—Å |
|---|------------|-------------|--------|
| A01 | Broken Access Control | `access-control.test.js` | ‚úÖ |
| A02 | Cryptographic Failures | ‚Äî | ‚è≥ |
| A03 | Injection (SQL, NoSQL) | `sql-injection.test.js` | ‚úÖ |
| A07 | XSS | `xss.test.js` | ‚úÖ |
| ‚Äî | Authentication | `auth.test.js` | ‚úÖ |
| ‚Äî | Rate Limiting | `rate-limiting.test.js` | ‚úÖ |

## üìù –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

### 1. SQL Injection (`sql-injection.test.js`)

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π –≤–æ –≤—Å–µ—Ö API endpoints:

```javascript
// –ü—Ä–∏–º–µ—Ä—ã payloads:
"'; DROP TABLE users; --"
"1 OR 1=1"
"1; SELECT * FROM users"
"' UNION SELECT * FROM users --"
```

### 2. XSS (`xss.test.js`)

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞:

```javascript
// –ü—Ä–∏–º–µ—Ä—ã payloads:
"<script>alert('xss')</script>"
"<img src=x onerror=alert('xss')>"
"javascript:alert('xss')"
```

### 3. Access Control (`access-control.test.js`)

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç IDOR (Insecure Direct Object Reference):

```javascript
// –°—Ü–µ–Ω–∞—Ä–∏–∏:
- User A –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ User B
- User –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–æ–≥–æ tenant
- User –±–µ–∑ –ø—Ä–∞–≤ –ø—ã—Ç–∞–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å —Ä–µ—Å—É—Ä—Å
```

### 4. Auth (`auth.test.js`)

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```javascript
// –°—Ü–µ–Ω–∞—Ä–∏–∏:
- JWT manipulation (–∏–∑–º–µ–Ω–µ–Ω–∏–µ payload)
- Expired token usage
- Invalid signature
- Token replay attacks
```

### 5. Rate Limiting (`rate-limiting.test.js`)

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç brute force:

```javascript
// –°—Ü–µ–Ω–∞—Ä–∏–∏:
- 100+ –∑–∞–ø—Ä–æ—Å–æ–≤ login –∑–∞ –º–∏–Ω—É—Ç—É
- 1000+ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –∑–∞ –º–∏–Ω—É—Ç—É
```

---

## üîß Fixtures

### payloads.js

–°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö payloads –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```javascript
export const SQL_PAYLOADS = [...];
export const XSS_PAYLOADS = [...];
export const JWT_PAYLOADS = [...];
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î** ‚Äî –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç –ø–æ–≤—Ä–µ–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
2. **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏** ‚Äî –µ—Å–ª–∏ –Ω–∞–π–¥—ë—Ç–µ –±–∞–≥, –∏—Å–ø—Ä–∞–≤—å—Ç–µ —Å–Ω–∞—á–∞–ª–∞
3. **Rate limiting —Ç–µ—Å—Ç—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ** ‚Äî –≤—ã–¥–µ–ª–∏—Ç–µ –≤—Ä–µ–º—è

---

## üö® –ù–ê–ô–î–ï–ù–ù–´–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò (–î–µ–∫–∞–±—Ä—å 2025)

### ‚ö†Ô∏è –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### 1. XSS –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –æ–± –æ—à–∏–±–∫–∞—Ö API

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Ä–≤–µ—Ä –æ—Ç—Ä–∞–∂–∞–µ—Ç XSS payload –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –æ–± –æ—à–∏–±–∫–∞—Ö –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

```json
// –ó–∞–ø—Ä–æ—Å:
GET /api/projects/<script>alert('xss')</script>

// –û—Ç–≤–µ—Ç:
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞",
  "error": "invalid input syntax for type uuid: \"<script>alert('xss')</script>\""
}
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π. XSS payload –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤ JSON, –Ω–æ JSON Content-Type –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø—Ä—è–º–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –æ–± –æ—à–∏–±–∫–∞—Ö:
```javascript
const sanitizeErrorMessage = (msg) => msg.replace(/[<>]/g, '');
```

---

### ‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting –Ω–∞ Login

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Ä–≤–µ—Ä –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç brute force –∞—Ç–∞–∫–∏ –Ω–∞ /api/auth/login.

```
20+ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ ‚Üí –ù–ï –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
```

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π. –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å express-rate-limit:
```javascript
const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  max: 5, // 5 –ø–æ–ø—ã—Ç–æ–∫
  message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞'
});
app.use('/api/auth/login', loginLimiter);
```

---

#### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting –Ω–∞ Registration

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–∂–Ω–æ —Å–ø–∞–º–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è–º–∏.

```
10+ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –ø–æ–¥—Ä—è–¥ ‚Üí –ù–ï –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π. –°–ø–∞–º –∞–∫–∫–∞—É–Ω—Ç–æ–≤, –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –õ–∏–º–∏—Ç 3 —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —á–∞—Å —Å –æ–¥–Ω–æ–≥–æ IP.

---

#### 4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting –Ω–∞ Password Reset

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–∂–Ω–æ —Å–ø–∞–º–∏—Ç—å –∑–∞–ø—Ä–æ—Å–∞–º–∏ –Ω–∞ —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è.

```
15+ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥ ‚Üí –ù–ï –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
```

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π. Email —Å–ø–∞–º, —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è email.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –õ–∏–º–∏—Ç 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ —á–∞—Å.

---

### ‚ÑπÔ∏è –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### 5. –ù–µ—Ç –ª–∏–º–∏—Ç–∞ –Ω–∞ —Ä–∞–∑–º–µ—Ä bulk import

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å 10000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ /api/materials/import.

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π. DoS —á–µ—Ä–µ–∑ –±–æ–ª—å—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –õ–∏–º–∏—Ç 500 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞ —Ä–∞–∑.

---

## ‚úÖ –ß–¢–û –ó–ê–©–ò–©–ï–ù–û

| –£—è–∑–≤–∏–º–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|--------|----------|
| SQL Injection | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–µ–∑–¥–µ |
| Stored XSS | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | JSON —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç HTML –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| JWT Manipulation | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –ü–æ–¥–ø–∏—Å—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è |
| IDOR | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –ü—Ä–æ–≤–µ—Ä–∫–∞ tenant_id –≤ middleware |
| Access Control | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | checkPermission middleware |
| Password Hash | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | bcrypt, hash –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è |

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –î–µ–∫–∞–±—Ä—å 2025*
