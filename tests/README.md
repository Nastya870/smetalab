# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞



**–í—Å—ë –æ —Ç–µ—Å—Ç–∞—Ö –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ!**  **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 22 –Ω–æ—è–±—Ä—è 2025  

**–°—Ç–∞—Ç—É—Å:** ‚úÖ 93/93 passing (100%)**–í—Å—ë –æ —Ç–µ—Å—Ç–∞—Ö –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ!**



------



## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å



``````

‚úÖ Unit Tests:        67/67 passing‚úÖ Unit Tests:        67/67 passing (100%)

‚úÖ Integration Tests: 26/26 passing‚úÖ Integration Tests: 26/26 passing (100%)

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üéØ –ò–¢–û–ì–û:            93/93 tests (100%)üéØ –ò–¢–û–ì–û:            93/93 passing (100%)

``````



------



## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ tests/## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ tests/



``````

tests/tests/

‚îú‚îÄ‚îÄ üìò README.md                 # ‚Üê –í–´ –ó–î–ï–°–¨‚îú‚îÄ‚îÄ üìò README.md                 # ‚Üê –í–´ –ó–î–ï–°–¨ (–≥–ª–∞–≤–Ω—ã–π –≥–∞–π–¥)

‚îú‚îÄ‚îÄ üìã TODO.md                   # –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è‚îú‚îÄ‚îÄ üìã TODO.md                   # –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

‚îÇ‚îú‚îÄ‚îÄ ‚öôÔ∏è setup.js                  # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ jsdom

‚îú‚îÄ‚îÄ üß™ unit/                     # 67 —Ç–µ—Å—Ç–æ–≤ ‚úÖ‚îÇ

‚îÇ   ‚îú‚îÄ‚îÄ backend/                 # middleware, utils‚îú‚îÄ‚îÄ üß™ unit/                     # Unit —Ç–µ—Å—Ç—ã (67 passing)

‚îÇ   ‚îî‚îÄ‚îÄ docs/README.md           # üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è‚îÇ   ‚îú‚îÄ‚îÄ backend/

‚îÇ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/          # checkPermission, auth

‚îú‚îÄ‚îÄ üîó integration/              # 26 —Ç–µ—Å—Ç–æ–≤ ‚úÖ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/               # JWT, password, bcrypt

‚îÇ   ‚îú‚îÄ‚îÄ api/                     # auth, roles‚îÇ   ‚îú‚îÄ‚îÄ frontend/

‚îÇ   ‚îî‚îÄ‚îÄ docs/README.md           # üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/

‚îÇ‚îÇ   ‚îî‚îÄ‚îÄ docs/

‚îú‚îÄ‚îÄ üåê e2e/                      # Playwright (–±—É–¥—É—â–µ–µ)‚îÇ       ‚îî‚îÄ‚îÄ README.md            # üìñ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è, –∫–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å

‚îÇ   ‚îî‚îÄ‚îÄ docs/README.md‚îÇ

‚îÇ‚îú‚îÄ‚îÄ üîó integration/              # Integration —Ç–µ—Å—Ç—ã (26 passing)

‚îú‚îÄ‚îÄ ‚ö° performance/              # k6 (–±—É–¥—É—â–µ–µ)‚îÇ   ‚îú‚îÄ‚îÄ api/

‚îÇ   ‚îî‚îÄ‚îÄ docs/README.md‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.api.test.js    # Auth endpoints (18 —Ç–µ—Å—Ç–æ–≤)

‚îÇ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ roles.api.test.js   # Roles endpoints (8 —Ç–µ—Å—Ç–æ–≤)

‚îú‚îÄ‚îÄ üîÑ shared/‚îÇ   ‚îî‚îÄ‚îÄ docs/

‚îÇ   ‚îú‚îÄ‚îÄ fixtures/                # testDatabase.js‚îÇ       ‚îî‚îÄ‚îÄ README.md            # üìñ API endpoints, troubleshooting

‚îÇ   ‚îî‚îÄ‚îÄ utilities/               # list-users.mjs, decode-jwt –∏ –¥—Ä.‚îÇ

‚îÇ‚îú‚îÄ‚îÄ üåê e2e/                      # E2E —Ç–µ—Å—Ç—ã (Playwright) - FUTURE

‚îú‚îÄ‚îÄ üõ†Ô∏è scripts/                  # –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞‚îÇ   ‚îî‚îÄ‚îÄ docs/

‚îÇ   ‚îú‚îÄ‚îÄ run-integration.ps1‚îÇ       ‚îî‚îÄ‚îÄ README.md            # üìñ –°—Ü–µ–Ω–∞—Ä–∏–∏, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Playwright

‚îÇ   ‚îî‚îÄ‚îÄ run-servers.ps1‚îÇ

‚îÇ‚îú‚îÄ‚îÄ ‚ö° performance/              # Performance —Ç–µ—Å—Ç—ã (k6) - FUTURE

‚îî‚îÄ‚îÄ üìö docs/                     # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞‚îÇ   ‚îî‚îÄ‚îÄ docs/

    ‚îú‚îÄ‚îÄ SESSION_21-22_NOV.md    # –î–µ—Ç–∞–ª–∏ —Å–µ—Å—Å–∏–∏‚îÇ       ‚îî‚îÄ‚îÄ README.md            # üìñ –ú–µ—Ç—Ä–∏–∫–∏, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ k6

    ‚îú‚îÄ‚îÄ TESTING_STRATEGY.md‚îÇ

    ‚îú‚îÄ‚îÄ PERMISSIONS_REFERENCE.md‚îú‚îÄ‚îÄ üîÑ shared/                   # –û–±—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã

    ‚îî‚îÄ‚îÄ ROLES_ARCHITECTURE.md‚îÇ   ‚îú‚îÄ‚îÄ fixtures/

```‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ testDatabase.js     # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î

‚îÇ   ‚îî‚îÄ‚îÄ utilities/               # –ë–î —É—Ç–∏–ª–∏—Ç—ã

---‚îÇ       ‚îú‚îÄ‚îÄ list-users.mjs

‚îÇ       ‚îú‚îÄ‚îÄ list-tenants.mjs

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç‚îÇ       ‚îú‚îÄ‚îÄ decode-jwt-token.cjs

‚îÇ       ‚îî‚îÄ‚îÄ ...

```powershell‚îÇ

# –í—Å–µ —Ç–µ—Å—Ç—ã‚îú‚îÄ‚îÄ üõ†Ô∏è scripts/                  # –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞

npm test‚îÇ   ‚îú‚îÄ‚îÄ run-integration.ps1     # –ó–∞–ø—É—Å–∫ integration —Ç–µ—Å—Ç–æ–≤

‚îÇ   ‚îî‚îÄ‚îÄ run-servers.ps1         # –ó–∞–ø—É—Å–∫ backend + frontend

# –¢–æ–ª—å–∫–æ unit‚îÇ

npm run test:unit‚îî‚îÄ‚îÄ üìö docs/                     # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

    ‚îú‚îÄ‚îÄ SESSION_21-22_NOV.md    # –î–µ—Ç–∞–ª–∏ —Å–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

# –¢–æ–ª—å–∫–æ integration    ‚îú‚îÄ‚îÄ TESTING_STRATEGY.md

npm run test:integration    ‚îú‚îÄ‚îÄ PERMISSIONS_REFERENCE.md

# –∏–ª–∏: .\tests\scripts\run-integration.ps1    ‚îú‚îÄ‚îÄ ROLES_ARCHITECTURE.md

    ‚îî‚îÄ‚îÄ ...

# –° coverage```

npm run test:coverage

---

# UI —Ä–µ–∂–∏–º

npm run test:ui## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç



# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä—ã### –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã

.\tests\scripts\run-servers.ps1```powershell

```# –ò–∑ –∫–æ—Ä–Ω—è vite/

npm test

---```



## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã

```powershell

### –ü–æ —Ç–∏–ø–∞–º —Ç–µ—Å—Ç–æ–≤npm run test:unit

- **[unit/docs/README.md](unit/docs/README.md)** ‚Äî Unit —Ç–µ—Å—Ç—ã```

- **[integration/docs/README.md](integration/docs/README.md)** ‚Äî Integration API

- **[e2e/docs/README.md](e2e/docs/README.md)** ‚Äî E2E (Playwright)### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ integration —Ç–µ—Å—Ç—ã

- **[performance/docs/README.md](performance/docs/README.md)** ‚Äî Performance (k6)```powershell

npm run test:integration

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **[docs/PERMISSIONS_REFERENCE.md](docs/PERMISSIONS_REFERENCE.md)** ‚Äî –†–∞–∑—Ä–µ—à–µ–Ω–∏—è# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

- **[docs/ROLES_ARCHITECTURE.md](docs/ROLES_ARCHITECTURE.md)** ‚Äî –†–æ–ª–∏.\test-scripts\run-integration.ps1

- **[docs/SESSION_21-22_NOV.md](docs/SESSION_21-22_NOV.md)** ‚Äî –î–µ—Ç–∞–ª–∏ —Å–µ—Å—Å–∏–∏```



---### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å coverage

```powershell

## üîß –£—Ç–∏–ª–∏—Ç—ãnpm run test:coverage

```

```powershell

# –ë–î —É—Ç–∏–ª–∏—Ç—ã### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π UI

node tests/shared/utilities/list-users.mjs```powershell

node tests/shared/utilities/list-tenants.mjsnpm run test:ui

node tests/shared/utilities/list-tables.mjs# –û—Ç–∫—Ä–æ–µ—Ç—Å—è http://localhost:51204

```

# Auth –æ—Ç–ª–∞–¥–∫–∞

node tests/shared/utilities/decode-jwt-token.cjs---

```

## üì¶ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è?

---

### 1. Unit Tests (67 —Ç–µ—Å—Ç–æ–≤)

## üì¶ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è?

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `tests/unit/**/*.test.js`

### Unit (67)

- ‚úÖ Auth: JWT —Ç–æ–∫–µ–Ω—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è#### Auth utilities (`tests/unit/auth.test.js`)

- ‚úÖ Password: bcrypt, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤ (access + refresh)

- ‚úÖ Permissions: wildcards, –∏–µ—Ä–∞—Ä—Ö–∏—è- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤

- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ payload –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤

### Integration (26)- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç—ë–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤

- ‚úÖ Auth API: register, login, refresh, logout, me- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

- ‚úÖ Roles API: list, get, permissions

#### Password utilities (`tests/unit/password.test.js`)

---- ‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)

- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è (–º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤)



–°–º. **[TODO.md](TODO.md)**:#### Permissions middleware (`tests/unit/checkPermission.test.js`)

1. ‚úÖ –ò–¥–µ–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ tests/- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

2. ‚è≥ CI/CD (GitHub Actions)- ‚úÖ Wildcard —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (`admin.*`)

3. ‚è≥ E2E (Playwright)- ‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (`admin.read` ‚Üí `materials.read`)

4. ‚è≥ Performance (k6)- ‚úÖ –û—Ç–∫–∞–∑ –≤ –¥–æ—Å—Ç—É–ø–µ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π



------



## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞### 2. Integration Tests (26 —Ç–µ—Å—Ç–æ–≤)



- ‚úÖ –í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (`tests/`)**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `tests/integration/api/**/*.test.js`

- ‚úÖ –õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è

- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä—è–¥–æ–º —Å —Ç–µ—Å—Ç–∞–º–∏#### Auth API (`tests/integration/api/auth.api.test.js`) - 18 —Ç–µ—Å—Ç–æ–≤

- ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–ª—è E2E –∏ Performance

- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**POST /api/auth/register** (5 —Ç–µ—Å—Ç–æ–≤)

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (201)

---- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º email (400)

- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–ª–∞–±–æ–º –ø–∞—Ä–æ–ª–µ (400)

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 22 –Ω–æ—è–±—Ä—è 2025 üéØ- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥—É–±–ª–∏—Ä—É—é—â–µ–º—Å—è email (409)

- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è (400)

**POST /api/auth/login** (5 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –í—Ö–æ–¥ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ credentials (200)
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º –ø–∞—Ä–æ–ª–µ (401)
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (401)
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ email (400)
- ‚úÖ JWT payload —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–æ–ª–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

**POST /api/auth/refresh** (3 —Ç–µ—Å—Ç–∞)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access token –ø–æ refresh token (200)
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º refresh token (401)
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ refresh token (400)

**POST /api/auth/logout** (2 —Ç–µ—Å—Ç–∞)
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–π logout (200)
- ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–∫–µ–Ω–∞ (401)

**GET /api/auth/me** (3 —Ç–µ—Å—Ç–∞)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (200)
- ‚úÖ –û—à–∏–±–∫–∞ –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ (401)
- ‚úÖ –û—à–∏–±–∫–∞ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º (403)

#### Roles API (`tests/integration/api/roles.api.test.js`) - 8 —Ç–µ—Å—Ç–æ–≤

**GET /api/roles** (4 —Ç–µ—Å—Ç–∞)
- ‚úÖ Super admin –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–æ–ª–∏ (super_admin, admin —à–∞–±–ª–æ–Ω)
- ‚úÖ Super admin –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –í–°–ï–ú —Ä–æ–ª—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ super_admin
- ‚úÖ Tenant admin –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ tenant roles —Å–≤–æ–µ–≥–æ —Ç–µ–Ω–∞–Ω—Ç–∞ (–∫—Ä–æ–º–µ admin)

**GET /api/permissions/roles/:id** (1 —Ç–µ—Å—Ç)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–æ–ª–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏

**Edge Cases** (3 —Ç–µ—Å—Ç–∞)
- ‚úÖ –û—à–∏–±–∫–∞ 401 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –û—à–∏–±–∫–∞ 403 —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º
- ‚úÖ –û—à–∏–±–∫–∞ 404 –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ä–æ–ª–∏

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### Unit Tests
```
tests/unit/
‚îú‚îÄ‚îÄ auth.test.js           # JWT, —Ç–æ–∫–µ–Ω—ã
‚îú‚îÄ‚îÄ password.test.js       # –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îî‚îÄ‚îÄ checkPermission.test.js # Middleware —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```

### Integration Tests
```
tests/integration/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ auth.api.test.js   # Auth endpoints (18 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ roles.api.test.js  # Roles endpoints (8 —Ç–µ—Å—Ç–æ–≤)
‚îî‚îÄ‚îÄ setup.js               # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ jsdom
```

### Test Utilities
```
tests/fixtures/
‚îî‚îÄ‚îÄ testDatabase.js        # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
    ‚îú‚îÄ‚îÄ cleanupTestData()      # –û—á–∏—Å—Ç–∫–∞ @test.com –¥–∞–Ω–Ω—ã—Ö
    ‚îú‚îÄ‚îÄ createTestUser()       # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚îú‚îÄ‚îÄ createTestTenant()     # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
    ‚îú‚îÄ‚îÄ assignRoleToUser()     # –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏
    ‚îî‚îÄ‚îÄ getRolePermissions()   # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —Ä–æ–ª–∏
```

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (21-22 –Ω–æ—è–±—Ä—è 2025)

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Data isolation
**–ë—ã–ª–æ:** Roles tests –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª–∏ —Å auth tests  
**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–æ–ª–∏—Ä–æ–≤–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `@rolestest.local` email domain

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Cleanup —É–¥–∞–ª—è–ª —á—É–∂–∏–µ tenants
**–ë—ã–ª–æ:** `cleanupTestData` —É–¥–∞–ª—è–ª –≤—Å–µ tenants —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º "Test %"  
**–†–µ—à–µ–Ω–∏–µ:** –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∏ cleanup —á—Ç–æ–±—ã —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ tenants –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ @test.com users

### –ü—Ä–æ–±–ª–µ–º–∞ 3: requireAdmin –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª super_admin
**–ë—ã–ª–æ:** Middleware —Ç—Ä–µ–±–æ–≤–∞–ª tenantId –¥–∞–∂–µ –¥–ª—è super_admin  
**–†–µ—à–µ–Ω–∏–µ:** –£–±—Ä–∞–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É tenantId –¥–ª—è super_admin

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `tests/fixtures/testDatabase.js` ‚Äî cleanup logic
- `server/middleware/adminAuth.js` ‚Äî requireAdmin middleware
- `tests/integration/api/roles.api.test.js` ‚Äî –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç

**1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```powershell
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å .env —Ñ–∞–π–ª —Å DATABASE_URL
cat .env | Select-String "DATABASE_URL"
```

**2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î**
```powershell
node test-scripts/debug/list-users.mjs
```

**3. –û—á–∏—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é**
```sql
DELETE FROM user_role_assignments WHERE user_id IN (SELECT id FROM users WHERE email LIKE '%@test.com%');
DELETE FROM user_tenants WHERE user_id IN (SELECT id FROM users WHERE email LIKE '%@test.com%');
DELETE FROM sessions WHERE user_id IN (SELECT id FROM users WHERE email LIKE '%@test.com%');
DELETE FROM users WHERE email LIKE '%@test.com%';
```

**4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –ø–æ-–æ–¥–Ω–æ–º—É**
```powershell
# –¢–æ–ª—å–∫–æ auth —Ç–µ—Å—Ç—ã
npx vitest run tests/integration/api/auth.api.test.js

# –¢–æ–ª—å–∫–æ roles —Ç–µ—Å—Ç—ã
npx vitest run tests/integration/api/roles.api.test.js
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **README_TESTING.md** ‚Äî –¥–µ—Ç–∞–ª–∏ —Å–µ—Å—Å–∏–∏ 21-22 –Ω–æ—è–±—Ä—è (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- **TODO.md** ‚Äî –ø–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π (CI/CD, E2E, performance)
- **docs/TESTING_STRATEGY.md** ‚Äî –æ–±—â–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **docs/PERMISSIONS_REFERENCE.md** ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º
- **docs/ROLES_ARCHITECTURE.md** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π

---

## üéì Best Practices

### 1. –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```javascript
// ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ email domains –¥–ª—è —Ä–∞–∑–Ω—ã—Ö test suites
beforeAll(async () => {
  const user = await testDb.createTestUser({
    email: 'unique-suite@test.com' // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π domain
  });
});
```

### 2. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ fixtures
```javascript
// ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏
const client = await testPool.connect();
await client.query('BEGIN');
try {
  // ... –æ–ø–µ—Ä–∞—Ü–∏–∏
  await client.query('COMMIT');
} catch (error) {
  await client.query('ROLLBACK');
  throw error;
} finally {
  client.release();
}
```

### 3. Cleanup –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
```javascript
// ‚úÖ –í—Å–µ–≥–¥–∞ –æ—á–∏—â–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ afterAll
afterAll(async () => {
  await testDb.cleanupTestData();
  await testDb.closePool();
});
```

---

## üö¶ CI/CD (TODO)

**–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:**
- GitHub Actions workflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
- Coverage reports –≤ Codecov
- Status badges –≤ README

**–°–º. —Ç–∞–∫–∂–µ:** `TODO.md` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–ª–∞–Ω–∞

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–í–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ—Å—Ç–∞–º?**
- –°–º. `README_TESTING.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –°–º. `docs/TESTING_STRATEGY.md` –¥–ª—è –æ–±—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 22 –Ω–æ—è–±—Ä—è 2025
